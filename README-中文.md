# 可视化故事写作工具 (Visual Story-Writing)

<img src="demo.gif" alt="演示动画">

## 🎯 项目简介

这是一个革命性的**可视化故事写作工具**，它能够自动分析您的故事文本，并将其中的**角色、动作、时间线和地点**以可视化的方式呈现出来。最神奇的是，您可以通过直接操作这些可视化元素来编辑故事，而不需要直接修改文字！

### 🌟 核心特色
- **自动故事可视化**：AI自动提取故事中的角色、动作、时间线和地点
- **可视化编辑**：通过拖拽、连接可视化元素来编辑故事
- **智能文本生成**：基于可视化操作自动生成相应的文字修改
- **时间线管理**：直观的时间线视图帮您管理故事的时间顺序
- **角色关系图**：清晰展示角色之间的互动关系

## 🔗 快速链接

- **[在线演示](https://damienmasson.com/VisualStoryWriting)** 
- **[安装运行指南](#-如何安装和运行)**
- **[论文链接](https://arxiv.org/abs/2410.07486)**

## 🚀 主要功能

### 1. 📚 故事可视化
- **角色分析**：自动识别故事中的所有角色，用头像和表情符号表示
- **动作提取**：分析角色之间的互动和行为
- **地点识别**：识别故事发生的各个场景和地点
- **时间线构建**：按时间顺序排列所有事件

### 2. 🎨 可视化编辑模式
- **连接角色**：在两个角色之间画线，系统会建议文字修改来体现他们的互动
- **移动角色**：拖拽角色到新位置，系统会更新文字描述
- **重排时间线**：拖拽时间线上的事件来改变故事顺序
- **悬停查看**：鼠标悬停在时间线上可以查看事件详情和角色移动

### 3. 🤖 AI智能助手
- 基于**GPT-4o**模型驱动
- 智能理解您的可视化操作意图
- 自动生成相应的文字修改建议
- 支持接受或拒绝AI的修改建议

## 💻 技术栈

| 技术 | 用途 | 版本 |
|-----|------|------|
| **React** | 前端框架 | 18.3.1 |
| **TypeScript** | 类型安全 | 5.2.2 |
| **Vite** | 构建工具 | 5.3.1 |
| **Zustand** | 状态管理 | 4.5.2 |
| **Slate.js** | 富文本编辑 | 0.103.0 |
| **ReactFlow** | 可视化图表 | 12.0.4 |
| **NextUI** | UI组件库 | 2.4.2 |
| **OpenAI API** | AI文本处理 | 4.52.0 |
| **TailwindCSS** | 样式框架 | 3.4.4 |

## 🛠️ 如何安装和运行

### 前提条件
- 安装 **Node.js** (推荐版本 16+)
- 获取 **OpenAI API密钥**

### 安装步骤

1. **克隆项目**
```bash
git clone <repository-url>
cd VisualStoryWriting
```

2. **安装依赖**
```bash
npm install
```

3. **运行开发服务器**
```bash
npm run dev
```

4. **访问应用**
打开浏览器访问：`http://localhost:5173`

### 打包部署
```bash
# 构建生产版本
npm run build

# 预览构建结果
npm run preview
```

## 🔑 如何获取OpenAI API密钥

1. 访问 [OpenAI官网](https://platform.openai.com/account/api-keys)
2. 注册或登录您的账户
3. 在API Keys页面创建新的密钥
4. 复制密钥并在应用中输入

**注意**：
- 您的API密钥不会被存储，仅用于向OpenAI发送请求
- 应用完全在本地运行，只有AI请求会发送到OpenAI服务器
- 如果没有正确的API密钥，您仍可以浏览界面，但无法执行AI功能

## 📖 使用教程

### 快速开始

1. **启动应用**：运行`npm run dev`后打开浏览器
2. **输入API密钥**：在启动页面输入您的OpenAI API密钥
3. **选择示例**：点击示例故事开始体验，或选择"空白页面"创建新故事

### 界面导览

#### 主界面布局
```
┌─────────────────┬─────────────────┐
│                 │                 │
│   文本编辑器     │   可视化面板     │
│                 │                 │
│                 │  [角色&动作][地点] │
├─────────────────┴─────────────────┤
│           时间线视图                │
│                                   │
└───────────────────────────────────┘
│           历史记录                  │
└───────────────────────────────────┘
```

#### 可视化面板切换
- **角色与动作标签**：显示角色关系图和他们之间的互动
- **地点标签**：显示故事中的各个场景位置

### 具体操作指南

#### 🎭 角色与动作编辑
1. **创建角色**：在角色视图中双击空白处，输入角色名称
2. **连接角色**：从一个角色拖拽到另一个角色，输入动作描述
3. **编辑角色**：点击角色节点进行编辑
4. **查看连接**：点击角色之间的连线查看互动详情

#### 📍 地点管理
1. **添加地点**：在地点视图中双击创建新地点
2. **移动角色位置**：拖拽角色到不同地点
3. **查看位置关系**：观察角色在不同地点的分布

#### ⏰ 时间线操作
1. **查看事件顺序**：时间线按时间顺序显示所有事件
2. **重排事件**：拖拽时间线上的事件改变顺序
3. **过滤查看**：选择部分事件进行重点查看
4. **悬停查看**：鼠标悬停查看事件详情

#### ✏️ 文本编辑
1. **直接编辑**：在左侧文本编辑器中直接修改文字
2. **AI建议**：基于可视化操作接收AI的修改建议
3. **接受/拒绝**：选择接受或拒绝AI的建议
4. **实时同步**：文本修改会实时更新可视化内容

### 🎯 使用技巧

#### 🔄 刷新可视化
- 修改文本后，点击右侧的**刷新按钮** (→) 更新可视化
- 系统会自动分析新的文本内容

#### 🔄 从可视化写作
- 操作可视化元素后，点击**从可视化写作按钮** (←) 
- AI会根据您的可视化操作重写文本

#### ⌨️ 键盘快捷键
- `Cmd/Ctrl + Z`：撤销
- `Cmd/Ctrl + Shift + Z`：重做
- `Esc`：取消当前选择
- `←/→`：在时间线中导航（当鼠标在时间线上时）

## 📁 项目结构解析

```
src/
├── 📁 model/               # 数据模型和AI逻辑
│   ├── Model.tsx          # 主要数据模型
│   ├── HistoryModel.tsx   # 历史记录管理
│   ├── ViewModel.tsx      # 视图状态管理
│   └── 📁 prompts/        # AI提示词和处理逻辑
│       ├── 📁 textEditors/    # 文本编辑AI提示
│       ├── 📁 textExtractors/ # 文本分析AI提示
│       └── 📁 utils/          # AI工具类
├── 📁 view/               # 用户界面组件
│   ├── Launcher.tsx       # 启动页面
│   ├── TextEditor.tsx     # 文本编辑器
│   ├── VisualWritingInterface.tsx # 主界面
│   ├── 📁 actionTimeline/     # 时间线组件
│   ├── 📁 entityActionView/   # 角色动作视图
│   └── 📁 locationView/       # 地点视图
├── 📁 study/              # 研究和测试相关
│   ├── StudyInterface.tsx # 研究界面
│   └── 📁 data/          # 示例数据
└── App.tsx               # 应用入口
```

### 核心文件说明

| 文件 | 功能 |
|------|------|
| `Model.tsx` | 管理故事数据、角色、动作、地点等核心状态 |
| `VisualWritingInterface.tsx` | 主界面布局，整合文本编辑器和可视化面板 |
| `TextEditor.tsx` | 基于Slate.js的富文本编辑器 |
| `EntitiesEditor.tsx` | 角色关系图编辑器 |
| `ActionTimeline.tsx` | 时间线视图组件 |
| `prompts/` | 包含所有AI提示词模板 |

## 🎓 学术研究

该项目源自学术研究，探索**可视化表示在故事写作中的应用**。主要研究内容包括：

- 📊 **用户研究**：比较传统文本编辑与可视化编辑的效果
- 🧠 **认知科学**：研究可视化如何辅助创意写作过程
- 🤖 **人机交互**：探索AI在创意写作中的角色

### 示例故事
项目包含多个精心设计的示例故事：
- **《爱丽丝梦游仙境》片段**
- **《雪橇冒险》**
- **《海浪相隔》**

## 🌐 浏览器支持

建议使用以下浏览器以获得最佳体验：
- **Google Chrome** (推荐)
- **Mozilla Firefox** 
- **Safari** (macOS)
- **Edge** (Windows)

## 🤝 贡献指南

欢迎为这个项目做出贡献！您可以：

1. **报告问题**：在GitHub Issues中报告bug或建议
2. **提交代码**：Fork项目并提交Pull Request
3. **改进文档**：帮助完善使用文档
4. **分享体验**：分享您的使用体验和改进建议

## 📄 开源协议

本项目采用开源协议，详见 `LICENSE` 文件。

## 🙋‍♀️ 常见问题

### Q: 为什么需要OpenAI API密钥？
A: 项目的核心AI功能依赖OpenAI的GPT-4o模型来理解和生成文本。您的密钥仅用于API调用，不会被存储。

### Q: 可以离线使用吗？
A: 用户界面可以离线浏览，但AI功能需要网络连接访问OpenAI API。

### Q: 支持哪些语言？
A: 理论上支持OpenAI API支持的所有语言，但界面主要以英文为主，中文支持良好。

### Q: 如何导出我的故事？
A: 目前您可以从文本编辑器中复制文本。后续版本可能会添加更多导出格式。

### Q: 性能要求如何？
A: 作为Web应用，对设备要求不高。建议使用现代浏览器和稳定的网络连接。

## 📞 联系我们

如果您有任何问题或建议，欢迎通过以下方式联系：

- 📧 GitHub Issues
- 🌐 [项目主页](https://damienmasson.com/VisualStoryWriting)
- 📄 [学术论文](https://arxiv.org/abs/2410.07486)

---

**开始您的可视化故事创作之旅吧！** ✨

> 让创意通过可视化绽放，让故事在互动中诞生。
